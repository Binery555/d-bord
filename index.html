<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Binance Signal Group — Admin-Only Chat + Members (100 Countries) + Profit Cards (Real Prices)</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://db.onlinewebfonts.com/c/d05c19ccecf7003d248c60ffd6b5e8f7?family=Binance+PLEX" rel="stylesheet"/>

<style>
  :root{
    --bg:#0b0f14; --panel:#0f1621; --panel2:#0b1320; --ink:#e6eef7; --muted:#9eb1c7;
    --line:#1a2736; --accent:#fcd535; --up:#16a34a; --down:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0; background:var(--bg); color:var(--ink); font-family:Inter, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;}
  .wrap{display:grid; grid-template-rows:auto 1fr auto; height:100vh;}
  header{display:flex; align-items:center; gap:16px; padding:14px 18px; border-bottom:1px solid var(--line); background:linear-gradient(180deg,#111827, #0b0f14 70%);} 
  .logo{width:36px; height:36px; border-radius:10px; background:radial-gradient(circle at 30% 30%, #ffd84d, #b99000); display:grid; place-items:center; font-weight:800; color:#111;}
  header h1{margin:0; font-size:18px; font-weight:700; letter-spacing:0.2px}
  header .sub{color:var(--muted); font-size:12px}
  .stats{margin-left:auto; display:flex; align-items:center; gap:22px}
  .stat{display:flex; flex-direction:column; align-items:flex-end}
  .stat .v{font-size:18px; font-weight:700}
  .segments{display:flex; gap:4px; align-items:center}
  .seg{width:22px; height:8px; border-radius:3px; background:#263446; outline:1px solid #1e2a39}
  .seg.fill{background:var(--accent)}
  .seg.half{background:linear-gradient(90deg, var(--accent) 50%, #263446 50%)}
  main{display:grid; grid-template-columns:1fr 330px; gap:0; min-height:0;}
  .chat{display:flex; flex-direction:column; min-height:0;}
  .chat-head{display:flex; gap:10px; align-items:center; padding:10px 16px; border-bottom:1px solid var(--line); background:var(--panel2)}
  .pill{font-size:12px; padding:4px 8px; border-radius:999px; background:#152235; color:var(--muted); border:1px solid #1f3047}
  .chat-scroll{flex:1; overflow:auto; padding:16px; background:radial-gradient(1200px 400px at 20% -10%, rgba(252,213,53,0.06), transparent 50%), linear-gradient(180deg, #0c1118, #0b0f14)}
  .bub{max-width:70%; margin:10px 0; padding:12px 14px; border-radius:14px; line-height:1.35; font-size:14px; border:1px solid #213149}
  .bub.admin{margin-left:auto; background:#0f1b2c}
  .bub .meta{font-size:11px; color:var(--muted); margin-top:6px}
  .bub img{max-width:100%; border-radius:10px; margin-top:8px; display:block}
  .composer{display:grid; grid-template-columns:auto 1fr auto; gap:10px; align-items:center; padding:10px; background:var(--panel); border-top:1px solid var(--line)}
  .composer input[type="text"]{width:100%; background:#0d1522; border:1px solid #1f2a39; color:var(--ink); border-radius:10px; padding:12px 12px; outline:none}
  .composer input[type="file"]{display:none}
  .btn{background:var(--accent); color:#111; border:0; padding:10px 14px; font-weight:700; border-radius:10px; cursor:pointer}
  .btn:disabled{opacity:.4; cursor:not-allowed}
  .attach{background:#162236; color:var(--ink); border:1px dashed #2a3a52; padding:8px 12px; border-radius:10px; cursor:pointer}
  .attach small{color:var(--muted)}
  .role{margin-left:8px;}
  .role label{font-size:12px; color:var(--muted)}

  /* Right members panel */
  aside{border-left:1px solid var(--line); background:linear-gradient(180deg, #0d1421, #0b0f14); display:flex; flex-direction:column; min-height:0}
  .aside-head{padding:12px; border-bottom:1px solid var(--line); display:grid; gap:10px}
  .search{display:flex; gap:8px}
  .search input{flex:1; background:#0d1522; border:1px solid #1f2a39; color:var(--ink); border-radius:10px; padding:10px}
  .search select{background:#0d1522; border:1px solid #1f2a39; color:var(--ink); border-radius:10px; padding:10px}
  .members{overflow:auto; padding:8px 8px 14px}
  .row{display:grid; grid-template-columns:36px 1fr auto; gap:10px; align-items:center; padding:8px; border-radius:12px; border:1px solid #1b2740; background:#0d1626; margin-bottom:8px}
  .row img{width:36px; height:36px; border-radius:10px; object-fit:cover}
  .name{font-weight:600; font-size:13px}
  .country{font-size:12px; color:var(--muted)}
  .flag{font-size:18px}
  .loadmore{margin:8px;}

  /* Small screens */
  @media (max-width: 980px){
    main{grid-template-columns:1fr}
    aside{order:-1}
  }

  /* --- Profit Card (OLD compact, used before 2025-07-25) --- */
  .pcard{
    max-width:300px; width:min(90vw,300px);
    background:url('https://iili.io/KKAe9kv.md.gif') center/cover no-repeat;
    color:#fff; border-radius:10px; padding:0.5cm 14px; position:relative; overflow:hidden;
    box-shadow:0 8px 40px rgba(0,0,0,.45);
    font-family:"Binance PLEX","Segoe UI",Arial,sans-serif;
    font-variant-numeric:tabular-nums;
  }
  .pcard .inner{ transform:translateX(0.55cm); }
  .pcard .header{ display:flex; align-items:flex-start; gap:4px; margin-bottom:0.35cm; transform:translateX(-0.5cm); }
  .pcard .binance-logo{ width:11px; height:11px; margin-top:-1px; }
  .pcard .text-block{ display:flex; flex-direction:column; margin-top:-1px; }
  .pcard .binance-text{ font-weight:800; font-size:.45rem; color:#f0b90b; letter-spacing:.25px; }
  .pcard .futures-text{ font-size:.5rem; color:#fff; font-weight:700; line-height:1; }
  .pcard .trade-info{ margin:4px 0; font-size:.45rem; font-weight:600; display:flex; gap:0.25cm; }
  .pcard .short{ color:#ff4d6b; } .pcard .long{ color:#00c292; }
  .pcard .percentage{ font-size:1.2rem; font-weight:900; margin:5px 0; }
  .pcard .percentage.green{ color:#00c292; font-size:1.35rem; }
  .pcard .percentage.red{ color:#ff4d6b; }
  .pcard .price-section{ margin:5px 0 6px; }
  .pcard .price-line{ display:flex; justify-content:flex-start; gap:5px; margin-bottom:2px; }
  .pcard .price-label{ color:#ccc; font-size:.45rem; width:65px; font-weight:700; }
  .pcard .price-value{ color:#f0b90b; font-weight:800; font-size:.55rem; margin-left:12px; }
  .pcard .referral-section{ display:flex; align-items:center; gap:6px; margin-top:0.25cm; }
  .pcard .qr{ width:24px; height:24px; border-radius:4px; border:1px solid rgba(255,255,255,.18); object-fit:cover; }
  .pcard .ref-text{ font-size:.42rem; color:#ddd; font-weight:600; }
  .pcard .referral-code{ font-weight:800; font-size:.55rem; letter-spacing:.2px; }
  .pcard .app-text{ font-size:.42rem; color:#f0b90b; margin-top:0; font-weight:700; }

  /* --- Profit Card V2 (from 2025-07-25 to today) — styles adapted from provided standalone --- */
  .pnl-card{
    --card-w: 320px;
    --extra-h: 2cm;
    --last-shift: 2.6cm;
    --accent:#fcd535; --green:#0ecb81; --red:#ff6b6b; --ink:#fff; --muted:#bdbdbd;
    width:var(--card-w);
    border-radius:16px; overflow:hidden;
    background:#111 url("https://iili.io/KBlgIse.th.png") center/cover no-repeat;
    border:2px solid #2e2e2e; box-shadow:0 8px 24px rgba(0,0,0,.45);
    color:var(--ink); font-variant-numeric:tabular-nums;
  }
  .pnl-card .card-header{ padding:16px; display:flex; align-items:center; gap:12px; margin-bottom:calc(16px + var(--extra-h)/2); }
  .pnl-card .avatar{ width:40px; height:40px; border-radius:50%; overflow:hidden; flex:0 0 40px; }
  .pnl-card .avatar img{ width:100%; height:100%; object-fit:cover; }
  .pnl-card .username{ display:flex; flex-direction:column; line-height:1.1; }
  .pnl-card .username .name{ font-weight:600; font-size:13px; }
  .pnl-card .username .time{ font-size:11px; opacity:.9; }
  .pnl-card .card-body{ padding:0 16px calc(20px + var(--extra-h)/2); }
  .pnl-card .title{ font-size:16px; font-weight:800; text-transform:uppercase; letter-spacing:.2px; }
  .pnl-card .position{ margin:6px 0 10px; display:inline-flex; align-items:center; gap:10px; font-size:13px; font-weight:600; }
  .pnl-card .position .side.short{ color:var(--red); }
  .pnl-card .position .side.long{ color:var(--green); }
  .pnl-card .position .divider{ width:1px; height:12px; background:#6a6a6a; display:inline-block; }
  .pnl-card .position .lev{ color:#cfcfcf; }
  .pnl-card .pnl-line{ display:flex; align-items:baseline; gap:8px; margin:6px 0 8px; }
  .pnl-card .pnl-line .pnl{ font-size:32px; font-weight:800; letter-spacing:-.4px; color:var(--green); }
  .pnl-card .pnl-line .usdt{ font-size:16px; font-weight:700; }
  .pnl-card .prices{ position:relative; display:flex; justify-content:space-between; gap:16px; font-size:12px; }
  .pnl-card .prices .label{ color:#9a9a9a; font-size:11px; }
  .pnl-card .prices .value{ color:#fff; }
  .pnl-card .prices .last{ position:relative; left:calc(-1 * var(--last-shift)); }
  .pnl-card .card-footer{ background:#000; }
  .pnl-card .footer-line{ display:block; height:1px; width:100%; background:#444; }
  .pnl-card .footer-content{ padding:14px 16px; padding-left:12px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
  .pnl-card .id-block{ display:grid; grid-template-columns:auto 1fr; grid-template-rows:auto auto auto; column-gap:8px; row-gap:2px; align-items:center; margin-left:-6px; }
  .pnl-card .id-logo{ grid-column:1/2; grid-row:1/2; width:16px; height:16px; display:block; position:relative; left:6px; }
  .pnl-card .id-logo img{ width:100%; height:100%; object-fit:contain; display:block; }
  .pnl-card .brand{ grid-column:2/3; grid-row:1/2; font-family:"Binance PLEX", Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:var(--accent); font-weight:900; font-size:11px; line-height:1; letter-spacing:.2px; text-transform:uppercase; }
  .pnl-card .futures{ grid-column:2/3; grid-row:2/3; font-size:14px; line-height:1; font-weight:800; text-transform:uppercase; color:#eaeaea; }
  .pnl-card .referral{ grid-column:2/3; grid-row:3/4; font-size:11px; line-height:1.1; color:#ffffff; letter-spacing:.1px; }
  .pnl-card .qr{ width:62px; height:62px; background:#fff; border-radius:6px; overflow:hidden; display:block; box-shadow:inset 0 0 0 1px #e5e5e5; }
  .pnl-card .qr img{ width:100%; height:100%; object-fit:cover; }
  .pnl-card .one-glyph{ font-family:"Binance PLEX", Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif !important; font-weight:700; }
  @media (max-width:360px){
    .pnl-card{ --card-w: 300px; --last-shift: 2.2cm; }
    .pnl-card .id-block{ margin-left:-8px; }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">B</div>
    <div>
      <h1>Binance Signal Group</h1>
      <div class="sub">Admin-only chat • Valid-countries member directory (≈100 countries)</div>
    </div>
    <div class="stats">
      <div class="stat">
        <div class="v" id="totalMembers">—</div>
        <small class="sub">Total Members (800K – 850K)</small>
      </div>
      <div class="stat">
        <div class="segments" id="segments"></div>
        <small class="sub">Laksha breakdown (8.x)</small>
      </div>
    </div>
  </header>

  <main>
    <!-- Chat Area -->
    <section class="chat">
      <div class="chat-head">
        <span class="pill">Admin Chat</span>
        <span class="pill">Only admin can send</span>
        <div class="role">
          <label><input type="checkbox" id="viewAsMember"> View as member (disable sending)</label>
        </div>
      </div>
      <div class="chat-scroll" id="chatScroll">
        <div class="bub">
          👋 Welcome to the Binance Signal Group. Admin posts official updates here.
          <div class="meta">System • just now</div>
        </div>
      </div>
      <div class="composer">
        <label class="attach" for="fileInput">📷 Attach photo <small>(optional)</small></label>
        <input id="msg" type="text" placeholder="Type admin message…"/>
        <button class="btn" id="sendBtn">Send</button>
        <input id="fileInput" type="file" accept="image/*"/>
      </div>
    </section>

    <!-- Members Panel -->
    <aside>
      <div class="aside-head">
        <div class="search">
          <input id="search" placeholder="Search member by name…"/>
          <select id="countryFilter"><option value="">All countries</option></select>
        </div>
        <small class="sub">Right panel: all members listed one by one with photo, name, country & flag. Use filters to jump.</small>
      </div>
      <div class="members" id="members"></div>
      <button class="btn loadmore" id="loadMore">Load more</button>
    </aside>
  </main>
</div>

<script>
/* ============================================================
   MEMBERS + HEADER STATS
============================================================ */
function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}
function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}

// Countries (~100)
const COUNTRIES = [
  {name:'Argentina', flag:'🇦🇷'},{name:'Australia', flag:'🇦🇺'},{name:'Austria', flag:'🇦🇹'},{name:'Azerbaijan', flag:'🇦🇿'},
  {name:'Bangladesh', flag:'🇧🇩'},{name:'Belgium', flag:'🇧🇪'},{name:'Brazil', flag:'🇧🇷'},{name:'Bulgaria', flag:'🇧🇬'},
  {name:'Cambodia', flag:'🇰🇭'},{name:'Canada', flag:'🇨🇦'},{name:'Chile', flag:'🇨🇱'},{name:'Colombia', flag:'🇨🇴'},
  {name:'Costa Rica', flag:'🇨🇷'},{name:'Croatia', flag:'🇭🇷'},{name:'Cyprus', flag:'🇨🇾'},{name:'Czechia', flag:'🇨🇿'},
  {name:'Denmark', flag:'🇩🇰'},{name:'Dominican Republic', flag:'🇩🇴'},{name:'Ecuador', flag:'🇪🇨'},{name:'Egypt', flag:'🇪🇬'},
  {name:'El Salvador', flag:'🇸🇻'},{name:'Estonia', flag:'🇪🇪'},{name:'Finland', flag:'🇫🇮'},{name:'France', flag:'🇫🇷'},
  {name:'Georgia', flag:'🇬🇪'},{name:'Germany', flag:'🇩🇪'},{name:'Ghana', flag:'🇬🇭'},{name:'Greece', flag:'🇬🇷'},
  {name:'Guatemala', flag:'🇬🇹'},{name:'Hong Kong', flag:'🇭🇰'},{name:'Hungary', flag:'🇭🇺'},{name:'Iceland', flag:'🇮🇸'},
  {name:'India', flag:'🇮🇳'},{name:'Indonesia', flag:'🇮🇩'},{name:'Ireland', flag:'🇮🇪'},{name:'Israel', flag:'🇮🇱'},
  {name:'Italy', flag:'🇮🇹'},{name:'Jamaica', flag:'🇯🇲'},{name:'Japan', flag:'🇯🇵'},{name:'Jordan', flag:'🇯🇴'},
  {name:'Kazakhstan', flag:'🇰🇿'},{name:'Kenya', flag:'🇰🇪'},{name:'Kuwait', flag:'🇰🇼'},{name:'Kyrgyzstan', flag:'🇰🇬'},
  {name:'Laos', flag:'🇱🇦'},{name:'Latvia', flag:'🇱🇻'},{name:'Lebanon', flag:'🇱🇧'},{name:'Lithuania', flag:'🇱🇹'},
  {name:'Luxembourg', flag:'🇱🇺'},{name:'Malaysia', flag:'🇲🇾'},{name:'Maldives', flag:'🇲🇻'},{name:'Malta', flag:'🇲🇹'},
  {name:'Mexico', flag:'🇲🇽'},{name:'Moldova', flag:'🇲🇩'},{name:'Mongolia', flag:'🇲🇳'},{name:'Morocco', flag:'🇲🇦'},
  {name:'Myanmar', flag:'🇲🇲'},{name:'Nepal', flag:'🇳🇵'},{name:'Netherlands', flag:'🇳🇱'},{name:'New Zealand', flag:'🇳🇿'},
  {name:'Nigeria', flag:'🇳🇬'},{name:'North Macedonia', flag:'🇲🇰'},{name:'Norway', flag:'🇳🇴'},{name:'Oman', flag:'🇴🇲'},
  {name:'Pakistan', flag:'🇵🇰'},{name:'Panama', flag:'🇵🇦'},{name:'Paraguay', flag:'🇵🇾'},{name:'Peru', flag:'🇵🇪'},
  {name:'Philippines', flag:'🇵🇭'},{name:'Poland', flag:'🇵🇱'},{name:'Portugal', flag:'🇵🇹'},{name:'Qatar', flag:'🇶🇦'},
  {name:'Romania', flag:'🇷🇴'},{name:'Saudi Arabia', flag:'🇸🇦'},{name:'Serbia', flag:'🇷🇸'},{name:'Singapore', flag:'🇸🇬'},
  {name:'Slovakia', flag:'🇸🇰'},{name:'Slovenia', flag:'🇸🇮'},{name:'South Africa', flag:'🇿🇦'},{name:'South Korea', flag:'🇰🇷'},
  {name:'Spain', flag:'🇪🇸'},{name:'Sri Lanka', flag:'🇱🇰'},{name:'Sweden', flag:'🇸🇪'},{name:'Switzerland', flag:'🇨🇭'},
  {name:'Taiwan', flag:'🇹🇼'},{name:'Tanzania', flag:'🇹🇿'},{name:'Thailand', flag:'🇹🇭'},{name:'Tunisia', flag:'🇹🇳'},
  {name:'Turkey', flag:'🇹🇷'},{name:'UAE', flag:'🇦🇪'},{name:'UK', flag:'🇬🇧'},{name:'Ukraine', flag:'🇺🇦'},
  {name:'Uruguay', flag:'🇺🇾'},{name:'Uzbekistan', flag:'🇺🇿'},{name:'Venezuela', flag:'🇻🇪'},{name:'Vietnam', flag:'🇻🇳'},
  {name:'Armenia', flag:'🇦🇲'},{name:'Albania', flag:'🇦🇱'},{name:'Bosnia & Herzegovina', flag:'🇧🇦'},{name:'Bolivia', flag:'🇧🇴'},
  {name:'Namibia', flag:'🇳🇦'},{name:'Zambia', flag:'🇿🇲'},{name:'Zimbabwe', flag:'🇿🇼'},{name:'Honduras', flag:'🇭🇳'},
  {name:'Nicaragua', flag:'🇳🇮'},{name:'Belarus', flag:'🇧🇾'}
];

// Generate mock members
const members = [];
const seedCount = 1200;
const firsts = ['Alex','Mia','Omar','Yuki','Ishan','Sara','Leo','Noah','Ava','Ethan','Layla','Nina','Ivan','Luis','Aria','Kai','Hana','Zara','Milan','Nora'];
const lasts = ['Chen','Silva','Khan','Perera','Singh','Kumar','Gomez','Ivanov','Lee','Nguyen','Hassan','Yilmaz','Costa','Santos','Hansen','Novak','Almeida','Park','Sato','Smith'];
for (let i=0;i<seedCount;i++){
  const c = COUNTRIES[i % COUNTRIES.length];
  const name = `${pick(firsts)} ${pick(lasts)}`;
  const avatarId = (i % 70) + 1;
  const photo = `https://i.pravatar.cc/150?img=${avatarId}`;
  members.push({id:i+1, name, country:c.name, flag:c.flag, photo});
}

// Header counts
const min = 800000, max = 850000;
const total = Math.floor(Math.random()*(max-min+1))+min;
document.getElementById('totalMembers').textContent = numberWithCommas(total);
const segmentsEl = document.getElementById('segments');
for(let i=0;i<8;i++){
  const d = document.createElement('div'); d.className='seg fill'; segmentsEl.appendChild(d);
}
const remainder = total - 800000;
if (remainder>0){
  const d = document.createElement('div');
  d.className = remainder>=50000? 'seg half':'seg';
  segmentsEl.appendChild(d);
}

// Members UI
const membersEl = document.getElementById('members');
const searchEl = document.getElementById('search');
const filterEl = document.getElementById('countryFilter');
const loadMoreBtn = document.getElementById('loadMore');
[...new Set(COUNTRIES.map(c=>c.name))].sort().forEach(n=>{
  const o = document.createElement('option'); o.value=n; o.textContent=n; filterEl.appendChild(o);
});
let viewSlice = 0; const PAGE=60;
function renderMembers(){
  const q = searchEl.value.toLowerCase().trim();
  const f = filterEl.value;
  const filtered = members.filter(m=>{
    return (q? m.name.toLowerCase().includes(q):true) && (f? m.country===f : true);
  });
  const toShow = filtered.slice(0, viewSlice);
  membersEl.innerHTML='';
  toShow.forEach(m=>{
    const row = document.createElement('div'); row.className='row';
    row.innerHTML = `
      <img src="${m.photo}" alt="${m.name}">
      <div>
        <div class="name">${m.name}</div>
        <div class="country">${m.country}</div>
      </div>
      <div class="flag" title="${m.country}">${m.flag}</div>
    `;
    membersEl.appendChild(row);
  });
  loadMoreBtn.style.display = (filtered.length>viewSlice)?'block':'none';
}
function resetAndRender(){ viewSlice = PAGE; renderMembers(); }
searchEl.addEventListener('input', resetAndRender);
filterEl.addEventListener('change', resetAndRender);
loadMoreBtn.addEventListener('click', ()=>{ viewSlice += PAGE; renderMembers(); });
resetAndRender();

// Admin chat basics
const chatScroll = document.getElementById('chatScroll');
const fileInput = document.getElementById('fileInput');
const msgInput = document.getElementById('msg');
const sendBtn = document.getElementById('sendBtn');
const viewAsMember = document.getElementById('viewAsMember');
function setRoleUI(){ const memberMode = viewAsMember.checked; msgInput.disabled = memberMode; sendBtn.disabled = memberMode; }
setRoleUI(); viewAsMember.addEventListener('change', setRoleUI);
let attachedDataUrl = null;
fileInput.addEventListener('change', ()=>{
  const f = fileInput.files[0];
  if(!f){attachedDataUrl=null; return}
  const r = new FileReader();
  r.onload = ()=>{attachedDataUrl = r.result;};
  r.readAsDataURL(f);
});
function addAdminMessage(text, img){
  const b = document.createElement('div'); b.className='bub admin';
  b.innerHTML = `${text ? text.replace(/</g,'&lt;') : ''}${img? `<img src="${img}" alt="attachment">`:''}<div class="meta">Admin • ${new Date().toLocaleString()}</div>`;
  chatScroll.appendChild(b); chatScroll.scrollTop = chatScroll.scrollHeight;
}
sendBtn.addEventListener('click', ()=>{
  if (viewAsMember.checked) return;
  const t = msgInput.value.trim(); if(!t && !attachedDataUrl) return;
  addAdminMessage(t, attachedDataUrl);
  msgInput.value=''; attachedDataUrl=null; fileInput.value='';
});
addAdminMessage('Today\'s BTC/USDT scalp plan: watch 1m/5m confluence near VWAP. SL tight, TP 2R.');
addAdminMessage('Upload proof or chart here if needed — admin can attach images to announcements.');
</script>

<script>
/* ============================================================
   PROFIT CARDS (REAL BINANCE FUTURES PRICES)
   REQUIREMENT:
   - Before 2025-07-25 -> OLD compact card (existing design)
   - From 2025-07-25 to today -> NEW provided profit card
   - Top name on NEW = uploader's name
   - Referral code unique per card
   - QR on NEW = same as old (https://iili.io/K1dUMml.jpg)
   - Keep everything else unchanged
============================================================ */
const API = {
  futuresKlines: 'https://fapi.binance.com/fapi/v1/klines',
  ping: 'https://fapi.binance.com/fapi/v1/ping'
};
const SYMBOLS = [
  'BTCUSDT','ETHUSDT','BNBUSDT','SOLUSDT','XRPUSDT','DOGEUSDT','ADAUSDT',
  'TONUSDT','AVAXUSDT','LINKUSDT','NEARUSDT','MATICUSDT','OPUSDT','ARBUSDT','ATOMUSDT'
];
const DOM_CAP = 500;
const ROI_RANGE = {min:300, max:3500}; // % inclusive
const NEW_TEMPLATE_START = new Date('2025-07-25T00:00:00Z');

const CHAT = document.getElementById('chatScroll');

/* Inject admin tools bar (unchanged UI) */
(function injectAdminTools(){
  const composer = document.querySelector('.composer');
  const bar = document.createElement('div');
  bar.className = 'admintools';
  bar.innerHTML = `
    <span class="muted">Profit Cards:</span>
    <label class="muted">Per day
      <input id="pcPerDay" type="number" min="1" max="200" value="100" style="width:70px">
    </label>
    <label class="muted">Leverage
      <select id="pcLev">
        <option>5</option><option>10</option><option selected>20</option><option>50</option><option>100</option>
      </select>x
    </label>
    <label class="muted">Side Mix
      <select id="pcSideMix">
        <option value="mixed" selected>Mixed</option>
        <option value="long">Long only</option>
        <option value="short">Short only</option>
      </select>
    </label>
    <label class="muted">Start
      <input id="pcStart" type="date">
    </label>
    <label class="muted">End
      <input id="pcEnd" type="date">
    </label>
    <button class="btn" id="pcGen20">Generate Sample (20)</button>
    <button class="btn" id="pcBackfill">Backfill 2 Years (Batched)</button>
    <button class="btn" id="pcExport">Export JSON</button>
  `;
  composer.parentNode.insertBefore(bar, composer);

  const today = new Date(); 
  const start = new Date(today); start.setDate(start.getDate()-730);
  bar.querySelector('#pcStart').value = start.toISOString().slice(0,10);
  bar.querySelector('#pcEnd').value = today.toISOString().slice(0,10);

  bar.querySelector('#pcGen20').addEventListener('click', async ()=>{
    await ensurePing();
    await generateCardsRandom(20, parseInt(bar.querySelector('#pcLev').value,10), bar.querySelector('#pcSideMix').value, dateRange(bar));
  });

  bar.querySelector('#pcBackfill').addEventListener('click', async ()=>{
    await ensurePing();
    await backfillRange(parseInt(bar.querySelector('#pcPerDay').value,10), parseInt(bar.querySelector('#pcLev').value,10), bar.querySelector('#pcSideMix').value, dateRange(bar));
  });

  bar.querySelector('#pcExport').addEventListener('click', exportJSON);
})();

function dateRange(barEl){
  const s = new Date(barEl.querySelector('#pcStart').value);
  const e = new Date(barEl.querySelector('#pcEnd').value);
  s.setHours(0,0,0,0); e.setHours(0,0,0,0);
  return {start:s, end:e};
}
function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }
function clampDom(){
  const bub = CHAT.querySelectorAll('.bub');
  const excess = Math.max(0, bub.length - DOM_CAP);
  for(let i=0;i<excess;i++) bub[i].remove();
}

/* Price cache */
const klinesCache = new Map();
async function ensurePing(){ try{ await fetch(API.ping, {cache:'no-store'}); }catch(e){} }
async function loadDailyKlines(symbol, startDate, endDate){
  const key = symbol + ':' + startDate.toISOString().slice(0,10) + ':' + endDate.toISOString().slice(0,10);
  if (klinesCache.has(key)) return klinesCache.get(key);
  const params = new URLSearchParams({
    symbol, interval:'1d',
    startTime: startDate.getTime(),
    endTime: endDate.getTime()
  });
  const res = await fetch(`${API.futuresKlines}?${params.toString()}`);
  if(!res.ok) throw new Error('Klines fetch failed for '+symbol);
  const data = await res.json();
  const slim = data.map(k => [k[0], parseFloat(k[1]), parseFloat(k[4])]); // [openTime, open, close]
  klinesCache.set(key, slim);
  return slim;
}
function priceOnDate(slimKlines, jsDate){
  const ymd = (d)=> new Date(d).toISOString().slice(0,10);
  const want = ymd(jsDate);
  const row = slimKlines.find(k=> ymd(k[0]) === want);
  if(!row) return null;
  return { open: row[1], close: row[2] };
}

/* --------- CARD BUILDERS --------- */
function fmt2(n){ return Number(n).toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2}); }

/* OLD compact card (before 2025-07-25) */
function makeProfitCardOld({side, leverage, symbol, entry, last, pct, ref}){
  const wrap = document.createElement('div');
  wrap.className = 'pcard';
  wrap.innerHTML = `
    <div class="inner">
      <div class="header">
        <img class="binance-logo" src="https://iili.io/KKRCyss.th.png" alt="Binance Logo" />
        <div class="text-block">
          <div class="binance-text">BINANCE</div>
          <div class="futures-text">FUTURES</div>
        </div>
      </div>
      <div class="trade-info">
        <span class="${side==='LONG'?'long':'short'}">${side==='LONG'?'Long':'Short'}</span>
        <span>|</span>
        <span>${leverage}x</span>
        <span>|</span>
        <span>${symbol} Perpetual</span>
      </div>
      <div class="percentage ${pct>=0?'green':'red'}">${pct>=0?'+':''}${pct.toFixed(2)}%</div>
      <div class="price-section">
        <div class="price-line">
          <span class="price-label">Entry Price</span>
          <span class="price-value">${fmt2(entry)}</span>
        </div>
        <div class="price-line">
          <span class="price-label">Last Price</span>
          <span class="price-value">${fmt2(last)}</span>
        </div>
      </div>
      <div class="referral-section">
        <img class="qr" src="https://iili.io/K1dUMml.jpg" alt="QR Code"/>
        <div>
          <div class="ref-text">Referral Code</div>
          <div class="referral-code">${ref}</div>
          <div class="app-text">Get the Binance App</div>
        </div>
      </div>
    </div>
  `;
  return wrap;
}

/* NEW provided profit card (from 2025-07-25 to today) */
function makeProfitCardNew({uploader, avatar, dateISO, side, leverage, symbol, entry, last, pct, ref}){
  const d = new Date(dateISO);
  const stamp = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} 14:49:58`;
  const card = document.createElement('div');
  card.className = 'pnl-card';
  card.innerHTML = `
    <div class="card-header">
      <div class="avatar"><img src="${avatar}" alt="${uploader} avatar"></div>
      <div class="username">
        <span class="name">${uploader}</span>
        <span class="time">${stamp}</span>
      </div>
    </div>

    <div class="card-body">
      <div class="title">${symbol} PERPETUAL</div>
      <div class="position">
        <span class="side ${side==='LONG'?'long':'short'}">${side==='LONG'?'Long':'Short'}</span>
        <span class="divider" aria-hidden="true"></span>
        <span class="lev">${leverage}x</span>
      </div>

      <div class="pnl-line">
        <div class="pnl">+${pct.toFixed(2)}</div>
        <div class="usdt">USDT</div>
      </div>

      <div class="prices">
        <div class="entry">
          <div class="label">Entry Price</div>
          <div class="value">${fmt2(entry)}</div>
        </div>
        <div class="last">
          <div class="label">Last Price</div>
          <div class="value">${fmt2(last)}</div>
        </div>
      </div>
    </div>

    <div class="card-footer">
      <span class="footer-line"></span>
      <div class="footer-content">
        <div class="id-block">
          <span class="id-logo"><img src="https://iili.io/KBDmWsn.th.png" alt="Binance logo"></span>
          <span class="brand">BINANCE</span>
          <span class="futures">FUTURES</span>
          <span class="referral">Referral Code ${ref}</span>
        </div>
        <span class="qr">
          <img src="https://iili.io/K1dUMml.jpg" alt="QR Code">
        </span>
      </div>
    </div>
  `;
  return card;
}

function addAdminBubble(node, caption){
  const b = document.createElement('div'); b.className='bub admin';
  b.appendChild(node);
  if (caption){
    const p = document.createElement('div'); p.style.marginTop='8px'; p.textContent = caption;
    b.appendChild(p);
  }
  const m = document.createElement('div'); m.className='meta'; m.textContent = `Admin • ${new Date().toLocaleString()}`;
  b.appendChild(m);
  CHAT.appendChild(b);
  CHAT.scrollTop = CHAT.scrollHeight;
  clampDom();
}

/* ROI helpers — profits only and within range */
function roiBasePct({entry, last, side}){
  const dir = (side==='LONG'? +1 : -1);
  return ((last - entry) / entry) * 100 * dir; // without leverage
}
function pickLeverageForRange(pctBase, min, max){
  if (pctBase <= 0) return null; // profits only
  let Lmin = Math.ceil(min / pctBase);
  let Lmax = Math.floor(max / pctBase);
  Lmin = Math.max(1, Lmin);
  Lmax = Math.min(125, Lmax);
  if (Lmin > Lmax) return null;
  const L = Math.floor(Math.random()*(Lmax - Lmin + 1)) + Lmin;
  return L;
}
function randomSide(mode){
  if (mode==='long') return 'LONG';
  if (mode==='short') return 'SHORT';
  return Math.random() < 0.5 ? 'LONG' : 'SHORT';
}
function randomRef(){ return String(Math.floor(100000000 + Math.random()*900000000)); }
function randomMember(){ return members[(Math.random()*members.length)|0]; }

/* Ledger for export */
const ledger = [];

/* Generators */
async function preloadRange(range){
  await Promise.all(SYMBOLS.map(s=>loadDailyKlines(s, range.start, range.end)));
}
async function generateCardsRandom(count, leverageHint, sideMix, range){
  await preloadRange(range);
  let made = 0, guard = 0;
  while (made < count && guard < count*300){
    guard++;
    const sym = pick(SYMBOLS);
    const day = new Date(range.start.getTime() + Math.random()*(range.end - range.start));
    day.setHours(0,0,0,0);
    const klKey = [...klinesCache.keys()].find(k=>k.startsWith(sym+':'));
    const kl = klinesCache.get(klKey);
    const px = priceOnDate(kl, day);
    if(!px) continue;

    // choose side ensuring PROFIT ONLY
    let side = randomSide(sideMix);
    const baseLong = roiBasePct({entry:px.open, last:px.close, side:'LONG'});
    const baseShort = roiBasePct({entry:px.open, last:px.close, side:'SHORT'});

    if (side==='LONG' && baseLong<=0 && baseShort>0) side='SHORT';
    if (side==='SHORT' && baseShort<=0 && baseLong>0) side='LONG';
    const pctBase = side==='LONG'? baseLong : baseShort;
    if (pctBase<=0) continue; // skip non-profit days for chosen side

    const lev = pickLeverageForRange(pctBase, ROI_RANGE.min, ROI_RANGE.max);
    if (!lev) continue;

    const entry = px.open, last = px.close;
    const pct = pctBase * lev;

    const m = randomMember();
    const ref = randomRef();
    const card = (day >= NEW_TEMPLATE_START)
      ? makeProfitCardNew({uploader:m.name, avatar:m.photo, dateISO:day.toISOString(), side, leverage:lev, symbol:sym, entry, last, pct, ref})
      : makeProfitCardOld({side, leverage:lev, symbol:sym, entry, last, pct, ref});

    const caption = `${m.name} (${m.country}) • ${sym} • ${side} • ${lev}x • ${day.toISOString().slice(0,10)}`;
    addAdminBubble(card, caption);
    ledger.push({date: day.toISOString().slice(0,10), member:m.name, country:m.country, symbol:sym, side, leverage:lev, entry, last, roi_pct:pct, referral:ref});
    made++;
    if (made % 10 === 0) await sleep(30);
  }
}
async function backfillRange(perDay, leverageHint, sideMix, range){
  await preloadRange(range);
  for (let t = range.start.getTime(); t <= range.end.getTime(); t += 86400000){
    const day = new Date(t);
    let made = 0, tries = 0;
    while (made < perDay && tries < perDay*100){
      tries++;
      const sym = SYMBOLS[tries % SYMBOLS.length];
      const klKey = [...klinesCache.keys()].find(k=>k.startsWith(sym+':'));
      const kl = klinesCache.get(klKey);
      const px = priceOnDate(kl, day);
      if(!px) continue;

      let side = randomSide(sideMix);
      const baseLong = roiBasePct({entry:px.open, last:px.close, side:'LONG'});
      const baseShort = roiBasePct({entry:px.open, last:px.close, side:'SHORT'});
      if (side==='LONG' && baseLong<=0 && baseShort>0) side='SHORT';
      if (side==='SHORT' && baseShort<=0 && baseLong>0) side='LONG';
      const pctBase = side==='LONG'? baseLong : baseShort;
      if (pctBase<=0) continue;

      const lev = pickLeverageForRange(pctBase, ROI_RANGE.min, ROI_RANGE.max);
      if (!lev) continue;

      const entry = px.open, last = px.close;
      const pct = pctBase * lev;

      const m = randomMember();
      const ref = randomRef();
      const card = (day >= NEW_TEMPLATE_START)
        ? makeProfitCardNew({uploader:m.name, avatar:m.photo, dateISO:day.toISOString(), side, leverage:lev, symbol:sym, entry, last, pct, ref})
        : makeProfitCardOld({side, leverage:lev, symbol:sym, entry, last, pct, ref});

      const caption = `${m.name} (${m.country}) • ${sym} • ${side} • ${lev}x • ${day.toISOString().slice(0,10)}`;
      addAdminBubble(card, caption);
      ledger.push({date: day.toISOString().slice(0,10), member:m.name, country:m.country, symbol:sym, side, leverage:lev, entry, last, roi_pct:pct, referral:ref});
      made++;
      if (made % 20 === 0) await sleep(50);
    }
    await sleep(120);
  }
}

/* Export */
function exportJSON(){
  const blob = new Blob([JSON.stringify(ledger,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = `profit-cards-${new Date().toISOString().slice(0,10)}.json`;
  document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
}

/* Hook buttons */
(function wireButtons(){
  const bar = document.querySelector('.admintools');
  const getRange = ()=>({ start: new Date(bar.querySelector('#pcStart').value+'T00:00:00Z'), end: new Date(bar.querySelector('#pcEnd').value+'T00:00:00Z') });

  bar.querySelector('#pcGen20').addEventListener('click', async ()=>{
    await ensurePing();
    await generateCardsRandom(20, parseInt(bar.querySelector('#pcLev').value,10), bar.querySelector('#pcSideMix').value, getRange());
  });
  bar.querySelector('#pcBackfill').addEventListener('click', async ()=>{
    await ensurePing();
    await backfillRange(parseInt(bar.querySelector('#pcPerDay').value,10), parseInt(bar.querySelector('#pcLev').value,10), bar.querySelector('#pcSideMix').value, getRange());
  });
  bar.querySelector('#pcExport').addEventListener('click', exportJSON);
})();
</script>
</body>
</html>
