<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Global Reviews — 7 Languages, Auto-Save</title>
<style>
  :root{
    --bg:#0b0f14; --panel:#101826; --ink:#e6eef7; --muted:#9db1c8;
    --line:#1a2736; --accent:#22d3ee; --accent2:#22c55e; --warn:#f59e0b; --bad:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink); background:
      radial-gradient(80rem 40rem at -10% -10%, #0e1a2a 0%, transparent 60%),
      radial-gradient(60rem 30rem at 110% 120%, #082032 0%, transparent 60%),
      var(--bg);
    font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
  }
  header{
    position:sticky; top:0; z-index:10;
    backdrop-filter: blur(8px);
    background: color-mix(in srgb, #0a1220 70%, transparent);
    border-bottom:1px solid var(--line);
  }
  .wrap{max-width:1100px;margin:0 auto;padding:18px 16px}
  h1{font-size:1.6rem;margin:0;display:flex;gap:.6rem;align-items:center}
  .badge{font-size:.9rem; color:#0a1a12; background:linear-gradient(90deg,var(--accent2),#8bffb5);
    padding:.15rem .5rem; border-radius:999px; font-weight:700}
  .grid{display:grid; gap:16px}
  @media(min-width:960px){ .grid-2{grid-template-columns:1.1fr 2fr} }

  /* Panels */
  .card{background:linear-gradient(180deg,#0d1626,#0b1320); border:1px solid var(--line);
    border-radius:16px; padding:14px}
  .card h2{font-size:1.1rem;margin:.1rem 0 10px}
  label{display:block;font-size:.9rem;color:var(--muted);margin:.2rem 0}
  input[type="text"], select, textarea{
    width:100%; background:#0c1422; color:var(--ink);
    border:1px solid #152235; border-radius:12px; padding:10px 12px; outline:none;
  }
  textarea{min-height:96px; resize:vertical}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .btn{
    appearance:none; border:1px solid #17324a; background:#0e1b2c; color:var(--ink);
    padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600;
  }
  .btn.primary{border-color:#115e6a; background:linear-gradient(90deg,#0b3d4a,#0e5a6a)}
  .btn.success{border-color:#165a3a; background:linear-gradient(90deg,#0c3a2a,#135a3b)}
  .btn.warn{border-color:#5a4d16; background:linear-gradient(90deg,#3a2c0c,#5a4d13)}
  .btn:disabled{opacity:.6; cursor:not-allowed}

  /* Stars */
  .stars{display:inline-flex; gap:4px; align-items:center}
  .star{
    width:22px;height:22px; mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>') center/contain no-repeat;
    background:#203347; cursor:pointer; display:inline-block;
  }
  .star.on{ background:linear-gradient(180deg, #ffd54a, #f59e0b)}
  .star.half{
    background:
      linear-gradient(90deg, #ffd54a 50%, #203347 50%);
  }

  /* List + item */
  .toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:10px}
  .filters{display:flex; gap:10px; flex-wrap:wrap}
  .stat{color:var(--muted); font-size:.92rem}
  .rev{padding:12px 10px; border-bottom:1px dashed #183048}
  .rev:last-child{border-bottom:none}
  .rev header{display:flex; align-items:center; gap:8px; justify-content:space-between}
  .name{font-weight:700}
  .lang{font-size:.8rem; color:#8dd9ff; background:#0b2236; border:1px solid #12324e; padding:.15rem .45rem; border-radius:999px}
  .rating{display:flex; gap:2px}
  .rt{width:14px;height:14px; background:#354b63; mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="black" d="M8 12.3l3.7 2.2-1-4.2L14 7l-4.3-.4L8 2 6.3 6.6 2 7l3.3 3.3-1 4.2z"/></svg>') center/contain no-repeat}
  .rt.on{background:linear-gradient(180deg,#ffd54a,#f59e0b)}
  .date{color:var(--muted); font-size:.8rem}
  .text{margin-top:6px; line-height:1.5}
  .rtl{direction:rtl} /* Arabic */

  .pager{display:flex; gap:6px; flex-wrap:wrap; justify-content:center; padding:10px 0}
  .pagebtn{
    border:1px solid #183048; background:#0a1626; color:var(--ink);
    padding:6px 10px; border-radius:10px; cursor:pointer; font-size:.9rem;
  }
  .pagebtn.active{background:#102b3f; border-color:#1f6ab0}
  .empty{color:var(--muted); text-align:center; padding:16px}

  footer{color:var(--muted); text-align:center; padding:18px 8px}
  small a{color:#8deaff; text-decoration:none}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <h1>Global Reviews <span class="badge">Auto-Save</span></h1>
  </div>
</header>

<main class="wrap grid grid-2" style="margin-top:12px">
  <!-- LEFT: Add Review -->
  <section class="card">
    <h2>➕ Add a Review</h2>
    <div class="row">
      <div style="flex:1 1 180px">
        <label>Name</label>
        <input id="name" type="text" placeholder="Your name"/>
      </div>
      <div style="flex:1 1 180px">
        <label>Language</label>
        <select id="lang">
          <option value="en">English</option>
          <option value="ar">العربية (Arabic)</option>
          <option value="hi">हिन्दी (Hindi)</option>
          <option value="zh">中文 (Chinese)</option>
          <option value="ja">日本語 (Japanese)</option>
          <option value="es">Español (Spanish)</option>
          <option value="ru">Русский (Russian)</option>
        </select>
      </div>
    </div>
    <div style="margin-top:8px">
      <label>Rating</label>
      <div id="starPicker" class="stars" aria-label="Pick rating" title="Pick rating"></div>
    </div>
    <div style="margin-top:8px">
      <label>Review</label>
      <textarea id="text" placeholder="Write your review..."></textarea>
    </div>
    <div class="row" style="margin-top:10px">
      <button id="addBtn" class="btn primary">Save Review</button>
      <button id="clearMineBtn" class="btn warn" title="Remove only generated seed to refill">Reset Seeds</button>
      <button id="wipeBtn" class="btn" title="Danger: remove all reviews">Wipe All</button>
    </div>
  </section>

  <!-- RIGHT: List & Filters -->
  <section class="card">
    <h2>🗂️ Reviews</h2>
    <div class="toolbar">
      <div class="filters">
        <select id="fLang" title="Filter by language">
          <option value="all">All languages</option>
          <option value="en">English</option>
          <option value="ar">العربية</option>
          <option value="hi">हिन्दी</option>
          <option value="zh">中文</option>
          <option value="ja">日本語</option>
          <option value="es">Español</option>
          <option value="ru">Русский</option>
        </select>
        <select id="fRating" title="Minimum rating">
          <option value="0">Min ★0</option>
          <option value="3">Min ★3</option>
          <option value="4" selected>Min ★4</option>
          <option value="5">★5 only</option>
        </select>
        <select id="fSort" title="Sort">
          <option value="new">Newest</option>
          <option value="top">Top rated</option>
        </select>
        <input id="fQuery" type="text" placeholder="Search text..."/>
        <select id="fPageSize" title="Per page">
          <option>10</option>
          <option selected>25</option>
          <option>50</option>
          <option>100</option>
        </select>
      </div>
      <div class="row">
        <button id="exportBtn" class="btn success">Export JSON</button>
        <label class="btn" for="importFile" style="position:relative; overflow:hidden">
          Import JSON
          <input id="importFile" type="file" accept="application/json" style="position:absolute; inset:0; opacity:0; cursor:pointer"/>
        </label>
      </div>
    </div>

    <div id="stats" class="stat">Loading…</div>
    <div id="list"></div>
    <div id="pager" class="pager"></div>
  </section>
</main>

<footer>
  <small>Auto-save uses your browser’s localStorage. Data stays on this device. • Made for English / العربية / हिन्दी / 中文 / 日本語 / Español / Русский • <a href="#" id="reseed">Re-generate 1500 demo reviews</a></small>
</footer>

<script>
(function(){
  // ---------- Storage helpers ----------
  const KEY = 'global_reviews_v1';
  const SEED_FLAG = 'global_reviews_seeded_v1';
  const read = () => JSON.parse(localStorage.getItem(KEY) || '[]');
  const write = (arr) => localStorage.setItem(KEY, JSON.stringify(arr));
  const seeded = () => localStorage.getItem(SEED_FLAG) === '1';
  const setSeeded = (v) => localStorage.setItem(SEED_FLAG, v ? '1' : '0');

  // ---------- Star picker ----------
  let currentRating = 5;
  const starPicker = document.getElementById('starPicker');
  function renderStarPicker(){
    starPicker.innerHTML = '';
    for(let i=1;i<=5;i++){
      const s = document.createElement('span');
      s.className = 'star' + (i <= currentRating ? ' on':'');
      s.title = i + ' star';
      s.addEventListener('click', ()=>{ currentRating = i; renderStarPicker(); });
      starPicker.appendChild(s);
    }
  }
  renderStarPicker();

  // ---------- Seed data (≈1500) ----------
  const PH = {
    en: {
      names: ['Alex','Jordan','Taylor','Sam','Chris','Morgan','Jamie','Riley','Casey','Avery','Drew','Rowan','Cameron'],
      texts: [
        'Fantastic experience! Very useful and easy to use.',
        'Clean UI and fast performance. Highly recommended.',
        'Helped my trading workflow a lot.',
        'Good features, would love more themes.',
        'Accurate, reliable, and simple. Love it!'
      ]
    },
    ar: {
      names: ['علي','سارة','أحمد','لينا','يوسف','مريم','كريم','نور','خالد','هند'],
      texts: [
        'تجربة رائعة وسهلة الاستخدام.',
        'واجهة جميلة وأداء سريع. أنصح به.',
        'ساعدني كثيرًا في التداول.',
        'ميزات جيدة وأتمنى إضافة سمات أكثر.',
        'دقيق وموثوق وبسيط.'
      ]
    },
    hi: {
      names: ['आर्यन','रिया','आदित्य','नेहा','विवान','अनुष्का','कृष','आयशा','सिया','रोहन'],
      texts: [
        'बहुत बढ़िया अनुभव, उपयोग करना आसान।',
        'UI साफ़ और प्रदर्शन तेज़।',
        'ट्रेडिंग वर्कफ़्लो में मदद मिली।',
        'फीचर अच्छे हैं, और थीम चाहिए।',
        'सटीक, भरोसेमंद और सरल।'
      ]
    },
    zh: {
      names: ['小明','小丽','王伟','李娜','陈刚','刘璐','张晨','赵静','孙杰','周婷'],
      texts: [
        '体验很棒，使用很方便。',
        '界面简洁，速度很快，值得推荐。',
        '对我的交易非常有帮助。',
        '功能不错，希望有更多主题。',
        '准确可靠，简单易用。'
      ]
    },
    ja: {
      names: ['ゆうた','さくら','はるき','みさき','そうた','りん','はるか','だいき','ゆい','あおい'],
      texts: [
        'とても使いやすく素晴らしい体験でした。',
        'UIが綺麗で高速。おすすめです。',
        '取引の作業効率が上がりました。',
        '機能は良いですが、テーマがもっと欲しいです。',
        '正確で信頼でき、シンプルです。'
      ]
    },
    es: {
      names: ['Juan','María','Carlos','Lucía','Diego','Sofía','Pedro','Ana','Luis','Elena'],
      texts: [
        '¡Experiencia fantástica! Muy útil y fácil.',
        'Interfaz limpia y rápida. Recomendado.',
        'Me ayudó mucho con el trading.',
        'Buenas funciones, quisiera más temas.',
        'Preciso, confiable y simple.'
      ]
    },
    ru: {
      names: ['Алексей','Анна','Иван','Мария','Дмитрий','Ольга','Сергей','Елена','Кирилл','Наталья'],
      texts: [
        'Отличный опыт! Простой и удобный.',
        'Чистый интерфейс и быстрая работа. Рекомендую.',
        'Сильно помог в трейдинге.',
        'Хорошие функции, хотелось бы больше тем.',
        'Точно, надёжно и просто.'
      ]
    }
  };
  const LANGS = ['en','ar','hi','zh','ja','es','ru'];

  function randomFrom(arr){ return arr[Math.floor(Math.random()*arr.length)] }
  function randBetween(a,b){ return Math.floor(Math.random()*(b-a+1))+a }

  function makeOne(lang, i, seedTag=true){
    const now = Date.now() - randBetween(0, 1000*60*60*24*120); // last 120 days
    const rating = [5,5,4,4,5,3][Math.floor(Math.random()*6)]; // bias high
    const name = randomFrom(PH[lang].names);
    const text = randomFrom(PH[lang].texts);
    return {
      id: crypto.randomUUID(),
      lang, name,
      rating,
      text,
      date: now,
      seed: !!seedTag
    };
  }

  function seedIfEmpty(){
    if (seeded()) return;
    let data = read();
    if (data.length > 0) { setSeeded(true); return; }
    const target = 1500; // ~1500 total
    const perLang = Math.floor(target / LANGS.length); // roughly equal share
    for(const lg of LANGS){
      for(let i=0;i<perLang;i++){
        data.push(makeOne(lg, i, true));
      }
    }
    // fill any remainder in English
    while(data.length < target) data.push(makeOne('en', 0, true));
    write(data);
    setSeeded(true);
  }

  // ---------- Render / Filters / Paging ----------
  const listEl = document.getElementById('list');
  const pagerEl = document.getElementById('pager');
  const statsEl = document.getElementById('stats');
  const fLang = document.getElementById('fLang');
  const fRating = document.getElementById('fRating');
  const fSort = document.getElementById('fSort');
  const fQuery = document.getElementById('fQuery');
  const fPageSize = document.getElementById('fPageSize');

  let page = 1;

  function fmtDate(ts){
    const d = new Date(ts);
    return d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});
  }

  function applyFilters(data){
    const lang = fLang.value;
    const minR = parseInt(fRating.value,10) || 0;
    const q = fQuery.value.trim().toLowerCase();
    let out = data.filter(r => (lang==='all' || r.lang===lang) && r.rating>=minR);
    if(q){
      out = out.filter(r => (r.name||'').toLowerCase().includes(q) || (r.text||'').toLowerCase().includes(q));
    }
    const sort = fSort.value;
    if(sort==='new'){ out.sort((a,b)=>b.date-a.date); }
    else if(sort==='top'){ out.sort((a,b)=> b.rating - a.rating || b.date - a.date ); }
    return out;
  }

  function render(){
    const data = read();
    const filtered = applyFilters(data);
    const total = filtered.length;
    const pageSize = parseInt(fPageSize.value,10)||25;
    const lastPage = Math.max(1, Math.ceil(total / pageSize));
    if(page>lastPage) page = lastPage;
    const start = (page-1)*pageSize;
    const slice = filtered.slice(start, start+pageSize);

    // stats
    const avg = data.length ? (data.reduce((a,r)=>a+r.rating,0)/data.length) : 0;
    statsEl.textContent = `Showing ${slice.length} of ${total} filtered • Total saved: ${data.length} • Avg rating: ${avg.toFixed(2)} ★`;

    // list
    listEl.innerHTML = '';
    if(slice.length===0){
      listEl.innerHTML = `<div class="empty">No reviews match your filters.</div>`;
    }else{
      const frag = document.createDocumentFragment();
      slice.forEach(r=>{
        const item = document.createElement('article');
        item.className = 'rev' + (r.lang==='ar' ? ' rtl' : '');
        item.innerHTML = `
          <header>
            <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
              <span class="name">${escapeHTML(r.name||'Anonymous')}</span>
              <span class="lang">${langLabel(r.lang)}</span>
              <span class="rating">${starsSmall(r.rating)}</span>
            </div>
            <span class="date">${fmtDate(r.date)}</span>
          </header>
          <div class="text">${escapeHTML(r.text||'')}</div>
        `;
        frag.appendChild(item);
      });
      listEl.appendChild(frag);
    }

    // pager
    pagerEl.innerHTML = '';
    if(lastPage>1){
      const mkBtn = (lab, toPage, active=false)=>{
        const b = document.createElement('button');
        b.className = 'pagebtn' + (active?' active':'');
        b.textContent = lab;
        b.addEventListener('click', ()=>{ page = toPage; render(); });
        return b;
      };
      pagerEl.appendChild(mkBtn('«', 1));
      pagerEl.appendChild(mkBtn('‹', Math.max(1, page-1)));
      const windowSize = 5;
      let from = Math.max(1, page - Math.floor(windowSize/2));
      let to = Math.min(lastPage, from + windowSize - 1);
      from = Math.max(1, to - windowSize + 1);
      for(let p=from; p<=to; p++){
        pagerEl.appendChild(mkBtn(String(p), p, p===page));
      }
      pagerEl.appendChild(mkBtn('›', Math.min(lastPage, page+1)));
      pagerEl.appendChild(mkBtn('»', lastPage));
    }
  }

  function starsSmall(n){
    let out = '';
    for(let i=1;i<=5;i++){
      out += `<span class="rt ${i<=n?'on':''}"></span>`;
    }
    return out;
  }
  function langLabel(code){
    return {
      en:'EN', ar:'AR', hi:'HI', zh:'ZH', ja:'JA', es:'ES', ru:'RU'
    }[code] || code.toUpperCase();
  }
  function escapeHTML(s){ return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }

  // ---------- Actions ----------
  document.getElementById('addBtn').addEventListener('click', ()=>{
    const name = document.getElementById('name').value.trim() || 'Anonymous';
    const lang = document.getElementById('lang').value;
    const text = document.getElementById('text').value.trim();
    if(!text){ alert('Please write a review.'); return; }
    const data = read();
    data.unshift({
      id: crypto.randomUUID(),
      lang, name, rating: currentRating, text, date: Date.now(), seed:false
    });
    write(data);
    document.getElementById('text').value='';
    render();
  });

  document.getElementById('wipeBtn').addEventListener('click', ()=>{
    if(confirm('Remove ALL reviews from this device?')){ write([]); setSeeded(false); render(); }
  });

  document.getElementById('clearMineBtn').addEventListener('click', ()=>{
    if(confirm('Remove existing seed reviews so you can reseed? (User reviews stay)')){
      const left = read().filter(r=>!r.seed);
      write(left); setSeeded(false); render();
    }
  });

  document.getElementById('exportBtn').addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(read(), null, 2)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'reviews-backup.json';
    a.click();
    URL.revokeObjectURL(a.href);
  });

  document.getElementById('importFile').addEventListener('change', (e)=>{
    const file = e.target.files[0];
    if(!file) return;
    const fr = new FileReader();
    fr.onload = ()=>{
      try{
        const arr = JSON.parse(fr.result);
        if(!Array.isArray(arr)) throw new Error('Invalid JSON');
        write(arr); setSeeded(true); render();
      }catch(err){
        alert('Invalid JSON: '+err.message);
      }
    };
    fr.readAsText(file);
    e.target.value='';
  });

  document.getElementById('reseed').addEventListener('click', (e)=>{
    e.preventDefault();
    if(!confirm('Re-generate ~1500 demo reviews? (User reviews kept)')) return;
    // keep user reviews, add seeds to reach 1500
    let data = read().filter(r=>!r.seed);
    const target = 1500;
    const toAdd = Math.max(0, target - data.length);
    const perLang = Math.floor(toAdd / LANGS.length);
    for(const lg of LANGS){ for(let i=0;i<perLang;i++) data.push(makeOne(lg, i, true)); }
    while(data.length < target) data.push(makeOne('en', 0, true));
    write(data); setSeeded(true); render();
  });

  fLang.addEventListener('change', ()=>{ page=1; render(); });
  fRating.addEventListener('change', ()=>{ page=1; render(); });
  fSort.addEventListener('change', ()=>{ page=1; render(); });
  fQuery.addEventListener('input', ()=>{ page=1; render(); });
  fPageSize.addEventListener('change', ()=>{ page=1; render(); });

  // ---------- Boot ----------
  seedIfEmpty();
  render();

})();
</script>

</body>
</html>
